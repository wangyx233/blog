---
title: 【网络】CDN
categories: ["网络"]
toc: true
---

> 前置知识：正向代理 & 反向代理

1. 正向代理其实是客户端的代理，帮助客户端访问其无法访问的服务器资源。正向代理一般是客户端架设的，反向代理一般是服务器架设的。反向代理则是服务器的代理，帮助服务器做负载均衡，安全防护等。
2. 正向代理中，服务器不知道真正的客户端到底是谁，以为访问自己的是真实的客户端。而在反向代理中，客户端不知道真正的服务器是谁，以为自己访问的是真实的客户端。
3. 正向代理和反向代理的作用和目的不同。正向代理主要是用来解决访问限制问题。而反向代理则是提供负载均衡、安全防护等作用。二者均能提高访问速度。

> CDN(Content Delivery Network) 是一种内容分发网络，部署在应用层，利用智能分配技术，根据用户访问的地点，按照就近访问的原则分配到多个节点，来实现多点负载均衡。简单来说，用户就近访问，访问速度更快，CDN 的常见实现是有一台源站服务器，多个 CDN 节点定时从源站同步。

CDN 的`缓存`和`回源`
“缓存”是说我们把资源推送一份到 CDN 服务器上这个过程，“回源”是说 CDN 发现自己没有这个资源或者资源过期了，从而去原站或者或者它的上层服务器请求这个资源的过程。

- 没有 CDN：用户访问域名 -> 域名解析成对应的 IP(DNS 解析) -> 根据 IP + 请求端口去服务器请求资源
- 用 CDN：用户访问域名 -> DNS 解析返回配置的 CNAME -> 智能调度 DNS 查询域名(CNAME)的 IP 地址(最适合的 CDN 节点) -> 根据 IP 访问 CDN 节点服务器 -> 有缓存返回，无则回源

Q & A

- 所以，CDN 是正向代理还是反向代理呢？
- 服务端有新的更新，如何清除 CDN 的缓存呢？

<!--more-->

- 当当当当然是反向代理啦，客户端不知道真正的服务端是谁咯。
- 常见的有两种方式：一是服务端把更新推送到 CDN 节点，二是通过不同的版本号进行区分。
